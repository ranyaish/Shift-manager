<!doctype html>
<html lang="he" dir="rtl">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>זמינות משמרות — עובד</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <meta name="theme-color" content="#0ea5e9" />
    <style>
      body { font-family: system-ui, -apple-system, Segoe UI, Roboto, 'Helvetica Neue', Arial; }
      .card { @apply bg-white rounded-2xl shadow p-4 md:p-6; }
      .btn { @apply px-4 py-2 rounded-xl font-semibold shadow disabled:opacity-50 disabled:cursor-not-allowed; }
      .btn-primary { @apply bg-sky-500 hover:bg-sky-600 text-white; }
      .btn-gray { @apply bg-gray-200 hover:bg-gray-300; }
      .input { @apply w-full border rounded-xl px-3 py-2 bg-white; }
      .sec { @apply text-lg font-bold mb-2; }
      .tag { @apply inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-xs font-medium bg-gray-100; }
    </style>
  </head>
  <body class="bg-gray-100 min-h-screen">
    <div class="max-w-3xl mx-auto p-4 md:p-8 space-y-6">
      <header class="flex items-center justify-between">
        <h1 class="text-3xl font-extrabold">זמינות משמרות — עובד</h1>
        <div class="flex items-center gap-2">
          <span id="whoami" class="text-sm text-gray-600 hidden"></span>
          <button id="btnSignOut" class="btn btn-gray hidden">התנתק</button>
        </div>
      </header>

      <!-- התחברות -->
      <section id="loginBox" class="card">
        <div class="sec">כניסת עובד</div>
        <div class="grid gap-3">
          <div>
            <label class="block text-sm mb-1">שם משתמש</label>
            <input id="username" class="input" placeholder="username" />
          </div>
          <div>
            <label class="block text-sm mb-1">סיסמה</label>
            <input id="password" type="password" class="input" placeholder="••••" />
          </div>
          <div class="flex items-center justify-between">
            <span class="text-xs text-gray-500">הכניסה מתבצעת מול טבלת <code>shifts.employee_credentials</code>.</span>
            <button id="btnLogin" class="btn btn-primary">כניסה</button>
          </div>
        </div>
      </section>

      <!-- אזור עובד -->
      <section id="employeeBox" class="hidden space-y-6">
        <div class="card">
          <div class="sec">פרטי עובד</div>
          <div class="grid md:grid-cols-2 gap-3">
            <div>
              <label class="block text-sm mb-1">שם מלא</label>
              <input id="empFullName" class="input" disabled />
            </div>
            <div>
              <label class="block text-sm mb-1">טלפון</label>
              <input id="empPhone" class="input" />
            </div>
            <div class="md:col-span-2">
              <label class="block text-sm mb-1">כתובת</label>
              <input id="empAddress" class="input" />
            </div>
          </div>
          <div class="mt-3">
            <button id="btnSaveProfile" class="btn btn-primary">שמור פרטים</button>
          </div>
        </div>

        <div class="card">
          <div class="sec">שליחת זמינות</div>
          <div class="grid md:grid-cols-4 gap-3">
            <div>
              <label class="block text-sm mb-1">תאריך</label>
              <input id="avDate" type="date" class="input" />
            </div>
            <div>
              <label class="block text-sm mb-1">משבצת</label>
              <select id="avSlot" class="input">
                <option value="lunch">צהריים (11–17)</option>
                <option value="dinner">ערב (17–23)</option>
                <option value="long">ארוכה (12–23)</option>
              </select>
            </div>
            <div class="md:col-span-2">
              <label class="block text-sm mb-1">הערה למנהל (אופציונלי)</label>
              <input id="avNote" class="input" placeholder="למשל: מעדיף להתחיל ב-12:30" />
            </div>
          </div>
          <div class="mt-3">
            <button id="btnSaveAvailability" class="btn btn-primary">שמור זמינות</button>
          </div>

          <div class="mt-4">
            <div class="sec">הזמינויות שלי לשבוע</div>
            <div id="myAvail" class="space-y-2 text-sm"></div>
          </div>
        </div>
      </section>
    </div>

    <!-- Supabase -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>
<script src="config.js?=v2"></script>
<script src="employee.js?=v2"></script>
    </body>
</html>
